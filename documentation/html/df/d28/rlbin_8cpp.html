<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RL-Bin: C:/Users/Amir/Desktop/RLBin-2.0/rlbin/rlbin.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RL-Bin
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
   <div id="projectbrief">Robust Low-overhead Binary Rewriter</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('df/d28/rlbin_8cpp.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">rlbin.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Creates target process and injects RL-Bin.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
Include dependency graph for rlbin.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/dfc/rlbin_8cpp__incl.jpg" border="0" usemap="#_c_1_2_users_2_amir_2_desktop_2_r_l_bin-2_80_2rlbin_2rlbin_8cpp" alt=""/></div>
<map name="_c_1_2_users_2_amir_2_desktop_2_r_l_bin-2_80_2rlbin_2rlbin_8cpp" id="_c_1_2_users_2_amir_2_desktop_2_r_l_bin-2_80_2rlbin_2rlbin_8cpp">
<area shape="rect"  title="Creates target process and injects RL&#45;Bin." alt="" coords="261,5,425,47"/>
<area shape="rect"  title=" " alt="" coords="5,102,77,129"/>
<area shape="rect"  title=" " alt="" coords="90,281,177,307"/>
<area shape="rect"  title=" " alt="" coords="559,102,625,129"/>
<area shape="rect"  title=" " alt="" coords="383,363,438,389"/>
<area shape="rect"  title=" " alt="" coords="649,102,716,129"/>
<area shape="rect"  href="../../d5/d64/defs_8h.html" title="Definitions used in the project." alt="" coords="271,273,433,315"/>
<area shape="rect"  href="../../dc/dd9/_r_l_bin_utils_8h.html" title="Handles all utility functions provided to RL&#45;Bin in RLBinUtils class." alt="" coords="153,184,314,225"/>
<area shape="rect"  href="../../d5/d29/_timer_8h.html" title="This file contains Timer class which has the responsibitly to measeure and report time." alt="" coords="322,95,483,136"/>
</map>
</div>
</div>
<p><a href="../../df/d28/rlbin_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0b97911b4fd957a78bf0f872c0c0f6c9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/rlbin_8cpp.html#a0b97911b4fd957a78bf0f872c0c0f6c9">InitProcess</a> (LPSTR target_cmd)</td></tr>
<tr class="memdesc:a0b97911b4fd957a78bf0f872c0c0f6c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates the target process with same startup attribute.  <a href="#a0b97911b4fd957a78bf0f872c0c0f6c9">More...</a><br /></td></tr>
<tr class="separator:a0b97911b4fd957a78bf0f872c0c0f6c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/rlbin_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a0ddf1224851353fc92bfbff6f499fa97"><td class="mdescLeft">&#160;</td><td class="mdescRight">The entry point for monitoring process.  <a href="#a0ddf1224851353fc92bfbff6f499fa97">More...</a><br /></td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a57eac93e2cadf24c70bfb07082854c36"><td class="memItemLeft" align="right" valign="top">PROCESS_INFORMATION&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/rlbin_8cpp.html#a57eac93e2cadf24c70bfb07082854c36">g_pInfo</a></td></tr>
<tr class="separator:a57eac93e2cadf24c70bfb07082854c36"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Creates target process and injects RL-Bin. </p>
<p>Defines the entry point for the console application. This application will start the taget process in suspended mode. Then it will inject inject.dll into the target process. After that it will resume the process and wait unitl it finishes. </p>

<p class="definition">Definition in file <a class="el" href="../../df/d28/rlbin_8cpp_source.html">rlbin.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0b97911b4fd957a78bf0f872c0c0f6c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b97911b4fd957a78bf0f872c0c0f6c9">&#9670;&nbsp;</a></span>InitProcess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool InitProcess </td>
          <td>(</td>
          <td class="paramtype">LPSTR&#160;</td>
          <td class="paramname"><em>target_cmd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates the target process with same startup attribute. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">programName</td><td>The name of target application and its arguments </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the target can be created successfully </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../df/d28/rlbin_8cpp_source.html#l00028">28</a> of file <a class="el" href="../../df/d28/rlbin_8cpp_source.html">rlbin.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d28/rlbin_8cpp_a0b97911b4fd957a78bf0f872c0c0f6c9_icgraph.jpg" border="0" usemap="#df/d28/rlbin_8cpp_a0b97911b4fd957a78bf0f872c0c0f6c9_icgraph" alt=""/></div>
<map name="df/d28/rlbin_8cpp_a0b97911b4fd957a78bf0f872c0c0f6c9_icgraph" id="df/d28/rlbin_8cpp_a0b97911b4fd957a78bf0f872c0c0f6c9_icgraph">
<area shape="rect"  title="Creates the target process with same startup attribute." alt="" coords="104,5,191,32"/>
<area shape="rect"  href="../../df/d28/rlbin_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="The entry point for monitoring process." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The entry point for monitoring process. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">argc</td><td>the number of arguments passed to target plus one</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">argv</td><td>the first argument is the target, the rest are arguments to the target </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>program execution status </dd></dl>
<p>The timer id for the whole program </p>

<p class="definition">Definition at line <a class="el" href="../../df/d28/rlbin_8cpp_source.html#l00046">46</a> of file <a class="el" href="../../df/d28/rlbin_8cpp_source.html">rlbin.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d28/rlbin_8cpp_a0ddf1224851353fc92bfbff6f499fa97_cgraph.jpg" border="0" usemap="#df/d28/rlbin_8cpp_a0ddf1224851353fc92bfbff6f499fa97_cgraph" alt=""/></div>
<map name="df/d28/rlbin_8cpp_a0ddf1224851353fc92bfbff6f499fa97_cgraph" id="df/d28/rlbin_8cpp_a0ddf1224851353fc92bfbff6f499fa97_cgraph">
<area shape="rect"  title="The entry point for monitoring process." alt="" coords="5,259,56,285"/>
<area shape="rect"  href="../../d8/d08/class_timer.html#a83f9003db23e504e9514055923d72b53" title="Creates the single instance of the Timer class." alt="" coords="147,5,247,32"/>
<area shape="rect"  href="../../d0/d89/class_r_l_bin_utils.html#a8f4fee562828f68a6429dd46cce30ea3" title="An API to log the error info for RLBin." alt="" coords="339,107,500,133"/>
<area shape="rect"  href="../../d8/d08/class_timer.html#ab1e5d80c0ee871e54178611e1a7888e1" title="gets the single instance of the Timer class" alt="" coords="156,107,239,133"/>
<area shape="rect"  href="../../d8/d08/class_timer.html#a96ab325fdf29a1aa5090d862f27953a1" title=" " alt="" coords="143,157,252,184"/>
<area shape="rect"  href="../../d8/d08/class_timer.html#acff72ff8020118ec73061297e8c6b3f1" title="This function creates and initialize a new timer." alt="" coords="127,208,267,235"/>
<area shape="rect"  href="../../d0/d89/class_r_l_bin_utils.html#a64f5d09180b506a4f151d7ba57df5b66" title="Initialize the analysis folder for the current execution." alt="" coords="143,259,251,285"/>
<area shape="rect"  href="../../d0/d89/class_r_l_bin_utils.html#a2bf2e6383028d09a421aec4367d610eb" title="Checks if a given file exists." alt="" coords="104,309,291,336"/>
<area shape="rect"  href="../../df/d28/rlbin_8cpp.html#a0b97911b4fd957a78bf0f872c0c0f6c9" title="Creates the target process with same startup attribute." alt="" coords="154,360,241,387"/>
<area shape="rect"  href="../../d0/d89/class_r_l_bin_utils.html#acbcaebf75e308dd6d421a529728626da" title="An utility function that prints log file for RLBin." alt="" coords="120,411,275,437"/>
<area shape="rect"  href="../../d8/d08/class_timer.html#a28a171eb4c64fb76f02ef93ff9f5c5ae" title="this function stops current time measurement for the given timer" alt="" coords="153,461,242,488"/>
<area shape="rect"  href="../../d8/d08/class_timer.html#addb28f30d8b8520ffbaf1f69d21c74ca" title="this function prints the average of the time intervals measured by given timer" alt="" coords="116,512,279,539"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a57eac93e2cadf24c70bfb07082854c36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57eac93e2cadf24c70bfb07082854c36">&#9670;&nbsp;</a></span>g_pInfo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PROCESS_INFORMATION g_pInfo</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Global variable used to pass the information of the process that is created. </p>

<p class="definition">Definition at line <a class="el" href="../../df/d28/rlbin_8cpp_source.html#l00021">21</a> of file <a class="el" href="../../df/d28/rlbin_8cpp_source.html">rlbin.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_37d9ff9ea336be680b4f7ba0ce5eaa9b.html">rlbin</a></li><li class="navelem"><a class="el" href="../../df/d28/rlbin_8cpp.html">rlbin.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
